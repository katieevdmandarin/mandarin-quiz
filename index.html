<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Katie Everyday Mandarin - Day 1-30 Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide-react/0.263.0/lucide-react.min.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";

        // Firebase Configuration (è«‹ç¢ºèªæ‚¨çš„ Firebase Console é…ç½®)
        const firebaseConfig = {
  apiKey: "AIzaSyDVDEEvvYjDJDUVkwG6tdDwRETXMiXmzsA",
  authDomain: "katie-mandarin.firebaseapp.com",
  projectId: "katie-mandarin",
  storageBucket: "katie-mandarin.firebasestorage.app",
  messagingSenderId: "565962775476",
  appId: "1:565962775476:web:0c36c51164de3be82c30e1",
  measurementId: "G-TY4DQT7VWZ"
        };

        const config = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : firebaseConfig;
        const app = initializeApp(config);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'katie-mandarin-official-quiz';

        // æ ¹æ“š CSV å…§å®¹åš´æ ¼æ ¡å°çš„ 10 é¡Œé¡Œåº«
        const quizData = [
            {
                question: "æƒ…å¢ƒï¼šç•¶ä½ è½ä¸æ¸…æ¥šï¼Œæƒ³è«‹å°æ–¹ã€Œå†èªªä¸€æ¬¡ã€æ™‚...\nScenario: You want to ask someone to say it again...",
                multi: "ğŸ‡®ğŸ‡© Bisa diulang sekali lagi?\nğŸ‡»ğŸ‡³ CÃ³ thá»ƒ nÃ³i láº¡i má»™t láº§n ná»¯a khÃ´ng?\nğŸ‡µğŸ‡­ Maaari mo bang ulitin?",
                options: [
                    { text: "é€™å€‹å¯ä»¥å†èªªä¸€æ¬¡å—ï¼Ÿ", pinyin: "ZhÃ¨ ge kÄ› yÇ zÃ i shuÅ yÃ­ cÃ¬ ma?", correct: true },
                    { text: "é€™å€‹å¤šå°‘éŒ¢ï¼Ÿ", pinyin: "ZhÃ¨ ge duÅ shÇo qiÃ¡n?", correct: false },
                    { text: "ä½ è¦å»å“ªè£¡ï¼Ÿ", pinyin: "NÇ yÃ o qÃ¹ nÇ lÇ?", correct: false }
                ],
                hint: "Keyword: 'zÃ i' (again) & 'shuÅ' (say)"
            },
            {
                question: "æƒ…å¢ƒï¼šå°æ–¹èªªè©±å¤ªå¿«äº†ï¼Œè«‹ä»–ã€Œèªªæ…¢ä¸€é»ã€...\nScenario: Someone is speaking too fast, ask them to slow down...",
                multi: "ğŸ‡®ğŸ‡© Bisa bicara lebih pelan?\nğŸ‡»ğŸ‡³ CÃ³ thá»ƒ nÃ³i cháº­m hÆ¡n khÃ´ng?\nğŸ‡µğŸ‡­ Maaari ka bang magsalita ng mas mabagal?",
                options: [
                    { text: "å¯ä»¥èªªå¿«ä¸€é»å—ï¼Ÿ", pinyin: "KÄ› yÇ shuÅ kuÃ i yÃ¬ diÇn ma?", correct: false },
                    { text: "å¯ä»¥èªªæ…¢ä¸€é»å—ï¼Ÿ", pinyin: "KÄ› yÇ shuÅ mÃ n yÃ¬ diÇn ma?", correct: true },
                    { text: "æˆ‘è½åˆ°äº†ã€‚", pinyin: "WÇ’ tÄ«ng dÃ o le.", correct: false }
                ],
                hint: "Focus: 'mÃ n' (slow)"
            },
            {
                question: "æƒ…å¢ƒï¼šåœ¨å·¥å» çœ‹åˆ°å±éšªï¼Œè¦æé†’åŒäº‹ã€Œå°å¿ƒã€æ™‚èªªï¼Ÿ\nScenario: Warning a colleague about a danger at work...",
                multi: "ğŸ‡®ğŸ‡© Hati-hati!\nğŸ‡»ğŸ‡³ Cáº©n tháº­n!\nğŸ‡µğŸ‡­ Ingat!",
                options: [
                    { text: "å°å¿ƒï¼", pinyin: "XiÇo xÄ«n!", correct: true },
                    { text: "è¾›è‹¦äº†ã€‚", pinyin: "XÄ«n kÇ” le.", correct: false },
                    { text: "è¬è¬ä½ ã€‚", pinyin: "XiÃ¨ xiÃ¨ nÇ.", correct: false }
                ],
                hint: "Keyword: 'XiÇo xÄ«n' (Watch out)"
            },
            {
                question: "æƒ…å¢ƒï¼šç•¶ä½ ä¸ç¢ºå®šå·¥å…·çš„æ“ä½œæ–¹æ³•ï¼Œæƒ³å•ã€Œé€™å€‹è¦æ€éº¼ç”¨ï¼Ÿã€...\nScenario: When you are not sure how to use a tool...",
                multi: "ğŸ‡®ğŸ‡© Bagaimana cara menggunakannya?\nğŸ‡»ğŸ‡³ CÃ¡i nÃ y dÃ¹ng nhÆ° tháº¿ nÃ o?\nğŸ‡µğŸ‡­ Paano gamitin ito?",
                options: [
                    { text: "é€™å€‹è¦æ€éº¼ç”¨ï¼Ÿ", pinyin: "ZhÃ¨ ge yÃ o zÄ›n me yÃ²ng?", correct: true },
                    { text: "ä½ åœ¨åšä»€éº¼ï¼Ÿ", pinyin: "NÇ zÃ i zuÃ² shÃ©n me?", correct: false },
                    { text: "ç¾åœ¨å¹¾é»ï¼Ÿ", pinyin: "XiÃ n zÃ i jÇ diÇn?", correct: false }
                ],
                hint: "Keyword: 'yÃ²ng' (use)"
            },
            {
                question: "æƒ…å¢ƒï¼šæƒ³è«‹åŒäº‹å¹«å¿™æ™‚ï¼Œæœ‰ç¦®è²Œåœ°å•ã€Œå¯ä»¥å¹«æˆ‘ä¸€ä¸‹å—ï¼Ÿã€...\nScenario: Politely asking a colleague for help...",
                multi: "ğŸ‡®ğŸ‡© Bisa bantu saya sebentar?\nğŸ‡»ğŸ‡³ GiÃºp tÃ´i má»™t chÃºt Ä‘Æ°á»£c khÃ´ng?\nğŸ‡µğŸ‡­ Maaari mo ba akong tulungan sandali?",
                options: [
                    { text: "ä½ å¯ä»¥å¹«æˆ‘ä¸€ä¸‹å—ï¼Ÿ", pinyin: "NÇ kÄ› yÇ bÄng wÇ’ yÃ­ xiÃ  ma?", correct: true },
                    { text: "ä½ åœ¨å“ªè£¡ï¼Ÿ", pinyin: "NÇ zÃ i nÇ lÇ?", correct: false },
                    { text: "æˆ‘è¦å¹«ä½ ã€‚", pinyin: "WÇ’ yÃ o bÄng nÇ.", correct: false }
                ],
                hint: "Keyword: 'bÄng' (help)"
            },
            {
                question: "æƒ…å¢ƒï¼šç•¶ä½ å®Œæˆå·¥ä½œï¼Œè¦å‘Šè¨´ä¸»ç®¡ã€Œæˆ‘åšå¥½äº†ã€...\nScenario: Telling your supervisor 'I have finished'...",
                multi: "ğŸ‡®ğŸ‡© Saya sudah selesai.\nğŸ‡»ğŸ‡³ TÃ´i lÃ m xong rá»“i.\nğŸ‡µğŸ‡­ Tapos ko na.",
                options: [
                    { text: "æˆ‘é‚„æ²’åšã€‚", pinyin: "WÇ’ hÃ¡i mÃ©i zuÃ².", correct: false },
                    { text: "æˆ‘åšå¥½äº†ã€‚", pinyin: "WÇ’ zuÃ² hÇo le.", correct: true },
                    { text: "æˆ‘ä¸åšäº†ã€‚", pinyin: "WÇ’ bÃº zuÃ² le.", correct: false }
                ],
                hint: "Keyword: 'zuÃ² hÇo' (finished)"
            },
            {
                question: "æƒ…å¢ƒï¼šæƒ³è©¢å•æ›´å¥½çš„åšæ³•ï¼Œå•ã€Œé€™æ¨£åšæ¯”è¼ƒå¥½å—ï¼Ÿã€...\nScenario: Asking for a better way, 'Is this way better?'...",
                multi: "ğŸ‡®ğŸ‡© Apakah cara ini lebih baik?\nğŸ‡»ğŸ‡³ CÃ¡ch nÃ y tá»‘t hÆ¡n khÃ´ng?\nğŸ‡µğŸ‡­ Mas maganda ba kung ganito ang gawin?",
                options: [
                    { text: "é€™æ¨£åšæ¯”è¼ƒå¥½å—ï¼Ÿ", pinyin: "ZhÃ¨ yÃ ng zuÃ² bÇ jiÃ o hÇo ma?", correct: true },
                    { text: "æˆ‘ä¸å–œæ­¡é€™æ¨£ã€‚", pinyin: "WÇ’ bÃ¹ xÇ huÄn zhÃ¨ yÃ ng.", correct: false },
                    { text: "ä½ åœ¨åšä»€éº¼ï¼Ÿ", pinyin: "NÇ zÃ i zuÃ² shÃ©n me?", correct: false }
                ],
                hint: "Day 26: 'bÇ jiÃ o hÇo' (better)"
            },
            {
                question: "æƒ…å¢ƒï¼šç•¶ä½ å­¸æœƒæ–°æŠ€å·§ï¼Œæƒ³å°è€å¸«æˆ–å‰è¼©èªªã€Œè¬è¬ä½ æ•™æˆ‘ã€...\nScenario: Thanking someone for teaching you...",
                multi: "ğŸ‡®ğŸ‡© Terima kasih sudah mengajari saya.\nğŸ‡»ğŸ‡³ Cáº£m Æ¡n báº¡n Ä‘Ã£ dáº¡y tÃ´i.\nğŸ‡µğŸ‡­ Salamat sa pagtuturo sa akin.",
                options: [
                    { text: "è¬è¬ä½ æ•™æˆ‘ã€‚", pinyin: "XiÃ¨ xiÃ¨ nÇ jiÄo wÇ’.", correct: true },
                    { text: "ä¸å®¢æ°£ã€‚", pinyin: "BÃº kÃ¨ qÃ¬.", correct: false },
                    { text: "æ²’é—œä¿‚ã€‚", pinyin: "MÃ©i guÄn xÃ¬.", correct: false }
                ],
                hint: "Day 28: 'jiÄo' (teach)"
            },
            {
                question: "æƒ…å¢ƒï¼šä¸‹ç­è¦é›¢é–‹æ™‚ï¼Œå°åŒäº‹èªªã€Œæ˜å¤©è¦‹ã€...\nScenario: Saying 'See you tomorrow' when leaving...",
                multi: "ğŸ‡®ğŸ‡© Sampai jumpa besok.\nğŸ‡»ğŸ‡³ Háº¹n gáº·p láº¡i ngÃ y mai.\nğŸ‡µğŸ‡­ Kita tayo bukas.",
                options: [
                    { text: "æ˜å¤©è¦‹ã€‚", pinyin: "MÃ­ng tiÄn jiÃ n.", correct: true },
                    { text: "å†è¦‹ã€‚", pinyin: "ZÃ i jiÃ n.", correct: false },
                    { text: "ä»Šå¤©è¦‹ã€‚", pinyin: "JÄ«n tiÄn jiÃ n.", correct: false }
                ],
                hint: "Keyword: 'MÃ­ng tiÄn' (tomorrow)"
            },
            {
                question: "æƒ…å¢ƒï¼šæƒ³è«‹æ•™å•é¡Œå‰ï¼Œæœ€æœ‰ç¦®è²Œçš„é–‹é ­æ˜¯ï¼Ÿ\nScenario: The most polite way to start a question...",
                multi: "ğŸ‡®ğŸ‡© Permisi, boleh tanya...?\nğŸ‡»ğŸ‡³ Xin há»i...?\nğŸ‡µğŸ‡­ Maaari bang magtanong...?",
                options: [
                    { text: "è«‹å•...", pinyin: "QÇng wÃ¨n...", correct: true },
                    { text: "å°ä¸èµ·ã€‚", pinyin: "DuÃ¬ bÃ¹ qÇ.", correct: false },
                    { text: "é¤µï¼", pinyin: "WÃ¨i!", correct: false }
                ],
                hint: "Day 1: 'QÇng wÃ¨n' (May I ask)"
            }
        ];

        let currentStep = 0;
        let score = 0;
        let userData = { name: '', email: '' };

        window.startQuiz = async () => {
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            if(!name || !email) return alert('è«‹å¡«å¯«å®Œæ•´è³‡è¨Š / Please fill in all information');
            
            userData = { name, email };
            await signInAnonymously(auth);
            
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            renderQuestion();
        };

        function renderQuestion() {
            const q = quizData[currentStep];
            document.getElementById('progress').style.width = `${((currentStep+1)/quizData.length)*100}%`;
            document.getElementById('q-title').innerText = q.question;
            document.getElementById('q-multi').innerText = q.multi;
            document.getElementById('q-hint').innerText = "ğŸ’¡ Hint: " + q.hint;
            
            const optionsHtml = q.options.map((opt, idx) => `
                <button onclick="handleAnswer(${opt.correct}, ${idx})" id="opt-${idx}" class="w-full text-left p-4 rounded-xl border-2 border-slate-100 hover:border-indigo-200 transition-all shadow-sm">
                    <div class="font-bold text-slate-800 text-lg">${opt.text}</div>
                    <div class="text-sm text-indigo-600 italic font-medium">${opt.pinyin}</div>
                </button>
            `).join('');
            document.getElementById('options-container').innerHTML = optionsHtml;
        }

        window.handleAnswer = async (isCorrect, idx) => {
            const btns = document.querySelectorAll('#options-container button');
            btns.forEach(b => b.disabled = true);
            
            const selected = document.getElementById(`opt-${idx}`);
            if(isCorrect) {
                selected.classList.replace('border-slate-100', 'border-emerald-500');
                selected.classList.add('bg-emerald-50');
                score++;
            } else {
                selected.classList.replace('border-slate-100', 'border-rose-500');
                selected.classList.add('bg-rose-50');
            }

            setTimeout(async () => {
                if(currentStep + 1 < quizData.length) {
                    currentStep++;
                    renderQuestion();
                } else {
                    await finishQuiz();
                }
            }, 1000);
        };

        async function finishQuiz() {
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('loading-screen').classList.remove('hidden');
            
            try {
                const resultsRef = collection(db, 'artifacts', appId, 'public', 'data', 'quiz_results');
                await addDoc(resultsRef, {
                    name: userData.name,
                    email: userData.email,
                    score: score,
                    total: quizData.length,
                    date: new Date().toISOString()
                });
            } catch(e) { console.error(e); }

            document.getElementById('loading-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            document.getElementById('final-score').innerText = `${score} / ${quizData.length}`;
            document.getElementById('user-msg').innerHTML = `æ­å–œ ${userData.name}ï¼<br>å–®å­—è¡¨å·²æº–å‚™å¥½ç™¼é€è‡³ï¼š<br><span class="text-indigo-600 font-bold">${userData.email}</span>`;
            document.getElementById('user-msg-en').innerText = `Congratulations! The Vocabulary List is ready to be sent to your email.`;
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .hidden { display: none; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen flex items-center justify-center p-4">

    <div class="max-w-md w-full bg-white rounded-3xl shadow-2xl overflow-hidden border border-slate-100">
        <!-- Header -->
        <div class="bg-indigo-600 p-8 text-white text-center">
            <h1 class="text-2xl font-extrabold tracking-tight italic">Katie Everyday Mandarin</h1>
            <p class="text-indigo-100 text-[10px] tracking-[0.2em] uppercase mt-2 font-bold">Day 1-30 Multilingual Review</p>
        </div>

        <!-- Login Screen -->
        <div id="login-screen" class="p-8">
            <h2 class="text-xl font-bold text-slate-800">é–‹å§‹è¤‡ç¿’æ¸¬é©—</h2>
            <p class="text-slate-400 text-sm mb-6 font-medium">Start Review Quiz</p>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1 ml-1">å§“å / Full Name</label>
                    <input id="name" type="text" placeholder="e.g. Katie Chen" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all">
                </div>
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1 ml-1">é›»å­éƒµä»¶ / Email Address</label>
                    <input id="email" type="email" placeholder="name@example.com" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all">
                </div>
                <button onclick="startQuiz()" class="w-full bg-indigo-600 text-white font-bold py-4 rounded-xl shadow-lg hover:bg-indigo-700 transition-all active:scale-[0.98] mt-4">
                    é€²å…¥æ¸¬é©— / Start Quiz
                </button>
            </div>
            <div class="mt-6 p-4 bg-amber-50 rounded-xl border border-amber-100 text-center">
                <p class="text-[10px] text-amber-700 leading-relaxed font-medium">
                    å®Œæˆæ¸¬é©—å³å¯é ˜å– Day 1-30 å®Œæ•´å–®å­—è¡¨<br>
                    Complete the quiz to receive the full Day 1-30 Vocabulary List.
                </p>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="p-8 hidden">
            <div class="flex justify-between items-center mb-2">
                <span class="text-[10px] font-bold text-indigo-500 uppercase tracking-widest">Progress</span>
                <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Question ${currentStep+1}/10</span>
            </div>
            <div class="w-full bg-slate-100 h-2 rounded-full mb-6 overflow-hidden">
                <div id="progress" class="bg-indigo-500 h-full transition-all w-0"></div>
            </div>
            
            <h3 id="q-title" class="text-lg font-bold text-slate-800 mb-2 leading-tight whitespace-pre-line"></h3>
            <div id="q-multi" class="text-xs text-slate-500 bg-slate-50 p-4 rounded-xl mb-4 whitespace-pre-wrap border border-slate-100 italic leading-relaxed"></div>
            
            <div id="options-container" class="space-y-3 mb-6"></div>
            
            <div id="q-hint" class="text-[10px] text-amber-600 font-bold bg-amber-50 p-2 rounded-lg text-center"></div>
        </div>

        <!-- Loading Screen -->
        <div id="loading-screen" class="p-12 text-center hidden">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"></div>
            <p class="mt-4 text-slate-500 font-bold text-sm uppercase tracking-widest">Saving Results...</p>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="p-8 text-center hidden">
            <div class="text-5xl mb-4">ğŸ‰</div>
            <h2 class="text-2xl font-bold text-slate-800">æ¸¬é©—å®Œæˆï¼</h2>
            <p class="text-slate-400 text-xs font-bold uppercase mb-6 tracking-widest">Quiz Completed</p>
            
            <p id="user-msg" class="text-sm text-slate-600 mb-2 leading-relaxed"></p>
            <p id="user-msg-en" class="text-[10px] text-slate-400 italic mb-6"></p>
            
            <div class="bg-indigo-50 rounded-2xl p-6 mb-6 border border-indigo-100 text-center">
                <div class="text-[10px] text-indigo-400 font-bold uppercase tracking-widest mb-1">Total Score / ç¸½åˆ†</div>
                <div id="final-score" class="text-4xl font-black text-indigo-600"></div>
            </div>
            <button onclick="window.location.reload()" class="text-indigo-600 font-bold text-sm hover:underline">
                å†æ¸¬ä¸€æ¬¡ / Try Again
            </button>
        </div>

        <div class="bg-slate-50 p-6 text-[10px] text-slate-400 text-center border-t border-slate-100">
            <strong>Katie Everyday Mandarin</strong> Â© 2025<br>
            <span class="opacity-70">Empowering your life in Taiwan through language.</span>
        </div>
    </div>

</body>
</html>

